// This flow handles the registration of a new super gluu device
Flow org.gluu.agama.supergluu.add
     Basepath ""
     Configs conf
     Inputs userData scimSetting
// Mark startup logs
Log "@debug Add a super gluu flow is started"
// Load pre-enrollment.ftlh page
obj = RRF "pre-enrollment.ftlh" 
When obj.cancelBtn is ""
     // Finish with cancellation event
     it_xnfsr = {success:false, error: "Pre enrollment cancellation"}
     Finish it_xnfsr
// Set inum = userData.inum
inum = userData.inum
// Get instance ScimFido2Helper
scimFido2Helper = Call org.gluu.agama.supergluu.ScimFido2Helper#new scimSetting
// List super gluu device by user
fidoDevice = Call scimFido2Helper getFidoDeviceByUser inum
// obj initialization
obj = { fidoDevice: fidoDevice, showError: false, errorTitle: "", errorMessage: "", canEdit: false }
Repeat 5 times max
     // Load list.ftlh page and pass obj
     listForm = RRF "list.ftlh" obj
     Log "@debug listForm response %" listForm